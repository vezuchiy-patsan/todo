"use strict";(self.webpackChunktodo=self.webpackChunktodo||[]).push([[670],{963:(e,t,s)=>{s.d(t,{A:()=>n});s(43);const n=s.p+"static/media/add-icon.0ef43df1c248bbc777cc3c5422c164e3.svg"},493:(e,t,s)=>{s.d(t,{a:()=>a});var n=s(43),i=s(443),l=s(579);const a=(0,n.memo)((e=>{let{isOpen:t,onClose:s,children:n}=e;if(!t)return null;return(0,l.jsx)("div",{className:"modal-overlay",onClick:e=>{e.target===e.currentTarget&&s()},children:(0,l.jsxs)("div",{className:"modal-content",children:[(0,l.jsx)("button",{className:"modal-close-button",onClick:s,children:(0,l.jsx)("img",{src:i.A,alt:"Close"})}),n]})})}))},670:(e,t,s)=>{s.r(t),s.d(t,{default:()=>w});var n=s(555),i=s(43),l=s(135),a=s(564),r=s(446),c=s.n(r),o=s(3),d=s(520),m=s(493),u=s(963),p=s(964),h=s(223),x=s(537),v=s(839),j=s(662),g=s(734);const k=e=>{if(0===e.length)return!0;const t=(new DOMParser).parseFromString(e,"text/html"),s=t.querySelectorAll(".tox-checklist li"),n=t.querySelectorAll(".tox-checklist--checked");return s.length>0&&s.length===n.length};var b=s(579);const y=(0,i.memo)((e=>{let{comment:t,addReply:s}=e;const[n,l]=(0,i.useState)("");return(0,b.jsxs)("div",{className:"comment",children:[(0,b.jsx)("div",{children:(0,b.jsx)("strong",{children:t.text})}),(0,b.jsx)("form",{onSubmit:e=>{e.preventDefault(),n.trim()&&(s(t.id,n),l(""))},children:(0,b.jsxs)("div",{className:"comment-text",children:[(0,b.jsx)("input",{type:"text",value:n,onChange:e=>l(e.target.value),placeholder:"\u0412\u0430\u0448 \u043e\u0442\u0432\u0435\u0442..."}),(0,b.jsxs)("button",{type:"submit",children:[(0,b.jsx)("div",{className:"svg-wrapper-1",children:(0,b.jsx)("div",{className:"svg-wrapper",children:(0,b.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"16",height:"16",children:[(0,b.jsx)("path",{fill:"none",d:"M0 0h24v24H0z"}),(0,b.jsx)("path",{fill:"currentColor",d:"M1.946 9.315c-.522-.174-.527-.455.01-.634l19.087-6.362c.529-.176.832.12.684.638l-5.454 19.086c-.15.529-.455.547-.679.045L12 14l6-8-8 6-8.054-2.685z"})]})})}),(0,b.jsx)("span",{children:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"})]})]})}),t.replies.length>0&&(0,b.jsx)("div",{className:"comment-replies",children:t.replies.map((e=>(0,b.jsx)(y,{comment:e,addReply:s},"comment-system-comment-reply-".concat(t.id,"-").concat(e.id))))})]})})),f=(0,i.memo)((e=>{let{idTask:t,projectId:s}=e;const a=(0,o.wA)(),r=(0,l.N)((e=>e.tasks.tasksProject)),[c,m]=(0,i.useState)([]),[u,p]=(0,i.useState)(""),[h,x]=(0,i.useState)(!1),v=e=>{const t={id:Date.now(),text:e,replies:[]};m([...c,t]),x(!0)},j=(e,t,s)=>e.map((e=>e.id===t?(0,n.A)((0,n.A)({},e),{},{replies:[...e.replies,s]}):(0,n.A)((0,n.A)({},e),{},{replies:j(e.replies,t,s)}))),g=(e,t)=>{m((s=>j(s,e,{id:Date.now(),text:t,replies:[]}))),x(!0)};return(0,i.useEffect)((()=>{if(h){const e={id:t,comments:c};a({type:d.x.ADD_COMMENT,payload:e}),x(!1),a({type:d.x.GET_TASK,payload:s})}}),[c,a,t,h,s]),(0,i.useEffect)((()=>{var e,s;m(null!==(e=null===(s=r.find((e=>e.id===t)))||void 0===s?void 0:s.comments)&&void 0!==e?e:[])}),[t,r]),(0,b.jsxs)("div",{className:"comment first-line",children:[(0,b.jsx)("h2",{children:"\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0438"}),(0,b.jsxs)("div",{className:"comment-text",children:[(0,b.jsx)("input",{type:"text",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439",value:u,onChange:e=>p(e.currentTarget.value),onKeyDown:e=>{"Enter"===e.key&&(v(u),p((()=>"")))}}),(0,b.jsxs)("button",{type:"submit",onClick:()=>{v(u),p((()=>""))},children:[(0,b.jsx)("div",{className:"svg-wrapper-1",children:(0,b.jsx)("div",{className:"svg-wrapper",children:(0,b.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"16",height:"16",children:[(0,b.jsx)("path",{fill:"none",d:"M0 0h24v24H0z"}),(0,b.jsx)("path",{fill:"currentColor",d:"M1.946 9.315c-.522-.174-.527-.455.01-.634l19.087-6.362c.529-.176.832.12.684.638l-5.454 19.086c-.15.529-.455.547-.679.045L12 14l6-8-8 6-8.054-2.685z"})]})})}),(0,b.jsx)("span",{children:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"})]})]}),c.map((e=>(0,b.jsx)(y,{comment:e,addReply:g},"comment-system-".concat(e.id))))]})}));var A=s(443);function N(e){let{task:t,columnId:s,addEditDeleteButtonClick:n}=e;const[l,a]=(0,i.useState)(!1),r=(0,i.useCallback)((()=>a((()=>!1))),[a]),[{isDragging:c},o]=(0,g.i)({type:"TASK",item:{id:t.id,fromColumn:s},collect:e=>({isDragging:!!e.isDragging()})});return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"card",ref:o,style:{opacity:c?.5:1},onClick:()=>n(!1,t),children:[!k(t.description)&&"done"===t.status&&(0,b.jsx)("div",{className:"notificate-alert",children:"\u041d\u0435 \u0432\u0441\u0435 \u043f\u043e\u0434\u0437\u0430\u0434\u0430\u0447\u0438 \u0437\u0430\u043a\u0440\u044b\u0442\u044b!"}),(0,b.jsxs)("div",{className:"main-section",children:[(0,b.jsxs)("div",{children:["#",t.numberTask," ",t.title]}),(0,b.jsx)("div",{className:"main-section-line-priority-".concat(t.priority)})]}),(0,b.jsx)("button",{onClick:e=>{e.stopPropagation(),n(!1,!1,null,t.id)},children:(0,b.jsx)("img",{src:A.A,alt:"delete"})}),(0,b.jsx)("div",{className:"comment-link",onClick:e=>{e.stopPropagation(),a((()=>!0))},children:"\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0438..."})]}),(0,b.jsx)(m.a,{isOpen:l,onClose:r,children:(0,b.jsx)(f,{idTask:t.id,projectId:t.projectId})})]})}const C=(0,i.memo)((e=>{let{columnId:t,column:s,inputs:n,handleInputChange:i,handleKeyDown:l,moveTask:a,addEditDeleteButtonClick:r}=e;const[c,o]=(0,p.H)({accept:"TASK",drop:e=>{a(e.id,e.fromColumn,t)}});return(0,b.jsxs)("div",{ref:o,className:"column",children:[(0,b.jsxs)("div",{className:"column-header",children:[(0,b.jsx)("h3",{children:s.title}),(0,b.jsx)("div",{className:"column-actions",children:(0,b.jsx)("button",{onClick:()=>r(!0,!1,t),children:(0,b.jsx)("img",{src:u.A,alt:"add"})})})]}),(0,b.jsxs)("div",{className:"cards",children:[s.tasks.map(((e,s)=>(0,b.jsx)(N,{task:e,columnId:t,addEditDeleteButtonClick:r},"".concat(s,"-").concat(e.title,"-").concat(e.id)))),(0,b.jsx)("input",{className:"card input-card",type:"text",placeholder:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0437\u0430\u0434\u0430\u0447\u0443...",value:n[t],onChange:e=>i(t,e.target.value),onKeyDown:e=>l(t,e)})]})]})}));function D(){const e=(0,o.wA)(),t=(0,i.useRef)(!0),s=(0,i.useRef)(null),{tasksProject:r,tasks:u}=(0,l.N)((e=>e.tasks)),{projectId:p}=(0,a.g)(),[g,k]=(0,i.useState)({queue:{title:"Queue",tasks:[]},development:{title:"Development",tasks:[]},done:{title:"Done",tasks:[]}}),[y,f]=(0,i.useState)({id:"",title:"",description:"",createdAt:"",attachments:[],comments:[],finishedAt:"",numberTask:0,priority:"low",projectId:null!==p&&void 0!==p?p:"",status:"queue",timeInWork:""}),[A,N]=(0,i.useState)({queue:"",development:"",done:""}),[D,w]=(0,i.useState)(!1),[T,S]=(0,i.useState)(!1),[I,E]=(0,i.useState)({add:!1,status:null}),K=()=>w((()=>!0)),M=(0,i.useCallback)((()=>w((()=>!1))),[w]),{getRootProps:q,getInputProps:z,fileRejections:B}=(0,j.VB)({multiple:!0,maxSize:1048576,accept:{"image/png":[".png",".jpeg"],"application/pdf":[".pdf"],"text/plain":[".txt"],"audio/mp3":[".mp3"]},onDragEnter:()=>S(!0),onDragLeave:()=>S(!1),onDrop:e=>{const t=e.map((e=>({name:e.name,size:e.size,type:e.type})));f((e=>(0,n.A)((0,n.A)({},e),{},{attachments:t})))}}),_=(0,i.useCallback)((function(){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return arguments.length>0&&void 0!==arguments[0]&&arguments[0]?(w((()=>!0)),E((()=>({add:!0,status:n}))),void K()):s&&"boolean"!==typeof s?(f((()=>s)),void K()):void(i&&(e({type:d.x.DELETE_TASK,payload:i}),t.current=!0))}),[e]),Y=(0,i.useCallback)(((e,t)=>{N((s=>(0,n.A)((0,n.A)({},s),{},{[e]:t})))}),[N]),H=(0,i.useCallback)(((s,i)=>{var l;if("Enter"===i.key&&""!==(null===(l=A[s])||void 0===l?void 0:l.trim())){var a,r,o,m;const l=[...u].sort(((e,t)=>Number(e.id)-Number(t.id))),p=[...u].sort(((e,t)=>Number(e.numberTask)-Number(t.numberTask))),h=Number(null!==(a=null===(r=l[l.length-1])||void 0===r?void 0:r.id)&&void 0!==a?a:"0")+1,x=Number(null!==(o=null===(m=p[p.length-1])||void 0===m?void 0:m.numberTask)&&void 0!==o?o:"0")+1,v={id:h.toString(),title:i.currentTarget.value,description:"",createdAt:c()().format("YYYY-MM-DDTHH:mm"),attachments:[],comments:[],finishedAt:"",numberTask:x,priority:"low",projectId:y.projectId,status:s,timeInWork:""};e({type:d.x.ADD_TASK,payload:v}),t.current=!0,N((e=>(0,n.A)((0,n.A)({},e),{},{[s]:""})))}}),[A,u,e,y.projectId]),P=(0,i.useCallback)((e=>{const{name:t,value:s}=e.target;f((e=>(0,n.A)((0,n.A)({},e),{},{[t]:s})))}),[]),R=(0,i.useCallback)(((s,i,l)=>{if(i===l)return;const a=g[i].tasks.find((e=>e.id===s));a&&(k((e=>(0,n.A)((0,n.A)({},e),{},{[i]:(0,n.A)((0,n.A)({},e[i]),{},{tasks:e[i].tasks.filter((e=>e.id!==s))}),[l]:(0,n.A)((0,n.A)({},e[l]),{},{tasks:[...e[l].tasks,a]})}))),e({type:d.x.EDIT_TASK,payload:(0,n.A)((0,n.A)({},a),{},{status:l})}),t.current=!0)}),[e,g]),O=(0,i.useCallback)((e=>{f((t=>(0,n.A)((0,n.A)({},t),{},{description:e})))}),[]);return(0,i.useEffect)((()=>{t.current&&(e({type:d.x.GET_TASK,payload:p}),t.current=!1)}),[p,t.current]),(0,i.useEffect)((()=>{const e=r.filter((e=>"queue"===e.status)),t=r.filter((e=>"development"===e.status)),s=r.filter((e=>"done"===e.status));k({queue:{title:"Queue",tasks:e},development:{title:"Development",tasks:t},done:{title:"Done",tasks:s}})}),[r]),(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(h.Q,{backend:x.t2,children:(0,b.jsx)("div",{className:"board",children:Object.entries(g).map(((e,t)=>{let[s,n]=e;return(0,b.jsx)(C,{column:n,columnId:s,handleInputChange:Y,handleKeyDown:H,inputs:A,moveTask:R,addEditDeleteButtonClick:_},"".concat(s,"-").concat(t))}))})}),(0,b.jsx)(m.a,{isOpen:D,onClose:M,children:(0,b.jsx)("div",{className:"form-container",children:(0,b.jsxs)("form",{className:"form",onSubmit:s=>{if(s.preventDefault(),I.add){var n,i,l,a,r;const t=u.sort(((e,t)=>Number(e.id)-Number(t.id))),s=u.sort(((e,t)=>Number(e.numberTask)-Number(t.numberTask))),o=Number(null!==(n=null===(i=t[t.length-1])||void 0===i?void 0:i.id)&&void 0!==n?n:"0")+1,m=Number(null!==(l=null===(a=s[s.length-1])||void 0===a?void 0:a.id)&&void 0!==l?l:"0")+1,p={id:o.toString(),title:y.title,description:y.description,createdAt:c()().format("YYYY-MM-DDTHH:mm"),attachments:[],comments:[],finishedAt:"",numberTask:m,priority:y.priority,projectId:y.projectId,status:null!==(r=I.status)&&void 0!==r?r:y.status,timeInWork:""};e({type:d.x.ADD_TASK,payload:p})}else e({type:d.x.EDIT_TASK,payload:y});E((()=>({add:!1,status:null}))),f({id:"",title:"",description:"",createdAt:"",attachments:[],comments:[],finishedAt:"",numberTask:0,priority:"low",projectId:null!==p&&void 0!==p?p:"",status:"queue",timeInWork:""}),M(),t.current=!0},children:[(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{htmlFor:"title",children:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u043f\u0440\u043e\u0435\u043a\u0442\u0430"}),(0,b.jsx)("input",{type:"text",id:"title",name:"title",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",value:y.title,onChange:P,required:!0})]}),(0,b.jsxs)("div",{className:"form-group",children:[(0,b.jsx)("label",{htmlFor:"description",children:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"}),(0,b.jsx)(v.K,{id:"description",apiKey:"gcw2m5ldvn8qh2io1pszbadkjws1zbt0h5vqhl3kgj2rbbb4",onInit:(e,t)=>s.current=t,init:{body_class:"semen",height:200,menubar:!1,plugins:"lists checklist",toolbar:"undo redo | bold italic | checklist",content_style:"ul { list-style-type: none; } li { display: flex; align-items: center; }",setup:e=>{e.ui.registry.addButton("checklist",{text:"\u2714",onAction:()=>{e.insertContent('<input type="checkbox"> ')}})}},value:y.description,onEditorChange:O})]}),(0,b.jsx)("label",{children:"\u041f\u0440\u0438\u043e\u0440\u0438\u0442\u0435\u0442"}),(0,b.jsxs)("div",{className:"radio-inputs",children:[(0,b.jsxs)("label",{className:"radio",children:[(0,b.jsx)("input",{type:"radio",name:"priority",value:"low",checked:"low"===y.priority,onChange:P}),(0,b.jsx)("span",{className:"name",children:"\u041d\u0438\u0437\u043a\u0438\u0439"})]}),(0,b.jsxs)("label",{className:"radio",children:[(0,b.jsx)("input",{type:"radio",name:"priority",value:"medium",onChange:P,checked:"medium"===y.priority}),(0,b.jsx)("span",{className:"name",children:"\u0421\u0440\u0435\u0434\u043d\u0438\u0439"})]}),(0,b.jsxs)("label",{className:"radio",children:[(0,b.jsx)("input",{type:"radio",name:"priority",value:"high",onChange:P,checked:"high"===y.priority}),(0,b.jsx)("span",{className:"name",children:"\u0412\u044b\u0441\u043e\u043a\u0438\u0439"})]})]}),(0,b.jsxs)("div",(0,n.A)((0,n.A)({},q()),{},{className:"dropzone ".concat(T?"dragover":""),children:[(0,b.jsx)("input",(0,n.A)({},z())),(0,b.jsx)("p",{children:"\u041f\u0435\u0440\u0435\u0442\u0430\u0449\u0438\u0442\u0435 \u0444\u0430\u0439\u043b\u044b \u0441\u044e\u0434\u0430 \u0438\u043b\u0438 \u043a\u043b\u0438\u043a\u043d\u0438\u0442\u0435 \u0434\u043b\u044f \u0432\u044b\u0431\u043e\u0440\u0430 (\u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u0440\u0430\u0437\u043c\u0435\u0440 \u0444\u0430\u0439\u043b\u0430: 1MB)"})]})),(0,b.jsxs)("div",{className:"file-preview",children:[y.attachments.length>0&&(0,b.jsx)("ul",{children:y.attachments.map((e=>(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:e.name})," -"," ",Math.round(e.size/1024)," KB"]},e.name)))}),B.length>0&&(0,b.jsx)("div",{className:"error-message",children:(0,b.jsx)("p",{children:"\u041d\u0435\u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0444\u0430\u0439\u043b\u044b \u0441\u043b\u0438\u0448\u043a\u043e\u043c \u0431\u043e\u043b\u044c\u0448\u0438\u0435! \u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u044b\u0439 \u0440\u0430\u0437\u043c\u0435\u0440 \u2014 1 MB."})})]}),(0,b.jsx)("button",{className:"form-submit-btn",type:"submit",children:I.add?"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u0440\u043e\u0435\u043a\u0442":"\u041e\u0442\u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"})]})})})]})}const w=(0,i.memo)(D)}}]);
//# sourceMappingURL=670.802c3f32.chunk.js.map